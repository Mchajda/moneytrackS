{% extends 'base.html.twig' %}

{% block title %}Inflation calculator{% endblock %}

{% block sidemenu %}
    <a href="{{ path('add_expense_form', {'year' : current_year, 'month' : current_month}) }}" class="btn btn-block btn-outline-primary"><span class="material-icons">add</span>Add Expense</a>
    <hr>
    <a href="{{ path('main') }}" class="btn btn-block btn-light text-left"><span class="material-icons mr-1">list</span>Home</a>
    <a href="{{ path('transactions', {'year' : current_year, 'month' : current_month}) }}" class="btn btn-block btn-light text-left"><span class="material-icons mr-1">shopping_cart</span>Transactions</a>
    <a href="{{ path('summary', {'year' : 'NOW'|date('Y'), 'month' : 'NOW'|date('m')}) }}" class="btn btn-block btn-light text-left"><span class="material-icons mr-1">auto_graph</span>Summary</a>
    <a href="{{ path('inflation') }}" class="btn btn-block btn-primary text-left"><b><span class="material-icons mr-1">auto_graph</span>Inflation</b></a>
    <a href="{{ path('crypto') }}" class="btn btn-block btn-light text-left"><span class="material-icons mr-1">auto_graph</span>Cryptocurrencies</a>
{% endblock %}

{% block body %}
<h4>Wartość twojego dzisiejszego budżetu na przestrzeni lat</h4>
<div style="height: 30rem; overflow: auto;" class="mb-4">
    <table class="table table-sm table-striped table-hover table-bordered">
        <thead class="thead-dark">
            <th>year</th>
            <th>value of your budget in specific year</th>
        </thead>
        <tbody>
        {% for infl in inflation %}
            <tr>
                <td>{{ infl.getYear() }}</td>
                <td>{{ (infl.getValue() * user.getBalance() / this_year_value)|round(2, 'floor') }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<div class="m-6">
    <h4>Wykres wartości twojego budżetu na przestrzeni lat</h4>
    <canvas id="monthChart"></canvas>
</div>
{% endblock %}

{% block javascripts %}
    <!-- Charts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js" integrity="sha512-d9xgZrVZpmmQlfonhQUvTR7lMPtO7NkZMkA0ABN3PHCbKA5nqylQ/yWlFAyY6hYgdF1Qh6nYiuADWwKB4C2WSw==" crossorigin="anonymous"></script>
    <script>
        let monthChart = document.getElementById('monthChart').getContext('2d');
        let chart = new Chart(monthChart, {
            type:'line',
            data:{
                labels:{{ inflation_years|json_encode()|raw }},
                datasets:[{
                    label:'',
                    data:{{ budget_converted|json_encode()|raw }},
                    backgroundColor: '#C4D0FB'
                }]
            },
            options:{
                legend: {
                    display: false
                }
            }
        });
    </script>
{% endblock %}